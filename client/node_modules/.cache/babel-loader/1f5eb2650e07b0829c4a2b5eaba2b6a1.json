{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"C:/Users/YAMATO/Desktop/LostItemTracking/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/YAMATO/Desktop/LostItemTracking/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/YAMATO/Desktop/LostItemTracking/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback}from'react';import dinner from'./dinner.png';import DialogUpdate from'./DialogUpdate';import DialogDelete from'./DialogDelete';var ExistedReport=function ExistedReport(){// const [images, setImages] = useState([]);\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),reports=_useState2[0],setReports=_useState2[1];var getAllReportFromDB=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('/api/findAllReport',{method:'post',headers:{'Accept':'application/json','Content-Type':'application/json'}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;if(!(data&&data.success===true)){_context.next=8;break;}return _context.abrupt(\"return\",data.data);case 8:return _context.abrupt(\"return\",null);case 9:case\"end\":return _context.stop();}}},_callee);}));return function getAllReportFromDB(){return _ref.apply(this,arguments);};}();var deleteReportFromDB=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch('/api/deleteReport',{method:'post',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({id:id})});case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:data=_context2.sent;if(data&&data.success===true){console.log(data.msg);}return _context2.abrupt(\"return\",null);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function deleteReportFromDB(_x){return _ref2.apply(this,arguments);};}();var onUpdateReport=function onUpdateReport(e){console.log(\"Updated Report ID: \"+e);};var onDeleteReport=function onDeleteReport(e){// console.log(\"Deleted Report ID: \" + e);\ndeleteReportFromDB(e);};var updateAllReport=useCallback(function(){getAllReportFromDB().then(function(res){return res.map(function(report){return{id:report.id,option:report.option,timestamp:report.timestamp,description:report.description,contact:report.contact};});}).then(function(infos){return setReports(infos);});},[]);useEffect(function(){updateAllReport();},[updateAllReport,reports]);var timestampToSTDTime=function timestampToSTDTime(timestamp){var date=new Date(timestamp);var year=date.getFullYear();var month=date.getMonth()+1;var day=date.getDate();// Hours part from the timestamp\nvar hours=date.getHours();// Minutes part from the timestamp\nvar minutes=\"0\"+date.getMinutes();var STDTime=year+'-'+month+'-'+day+' '+hours+':'+minutes.substr(-2);return STDTime;};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:reports.map(function(img){return/*#__PURE__*/_jsxs(\"div\",{className:\"box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"imgBox\",children:[/*#__PURE__*/_jsx(\"img\",{src:dinner,alt:\"\"}),/*#__PURE__*/_jsx(DialogUpdate,{id:img.id,option:img.option===0?'遺失':'拾獲',time:img.timestamp,desc:img.description,contact:img.contact,onUpdate:function onUpdate(){return onUpdateReport(img.id);}}),/*#__PURE__*/_jsx(DialogDelete,{id:img.id,onDelete:function onDelete(){return onDeleteReport(img.id);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"details\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsxs(\"h5\",{\"data-status\":img.option,children:[/*#__PURE__*/_jsx(\"b\",{children:img.option===0?\"失\":\"報\"}),\" \\u65BC \",timestampToSTDTime(img.timestamp)]}),/*#__PURE__*/_jsxs(\"p\",{children:[img.description,\"\\uFF0C\",img.option===0?\"如拾獲\":\"欲取回\",\"\\u8ACB\\u806F\\u7D61: \",img.contact]})]})})]});})});};export default ExistedReport;","map":{"version":3,"sources":["C:/Users/YAMATO/Desktop/LostItemTracking/client/src/components/ExistedReport.js"],"names":["React","useState","useEffect","useCallback","dinner","DialogUpdate","DialogDelete","ExistedReport","reports","setReports","getAllReportFromDB","fetch","method","headers","response","json","data","success","deleteReportFromDB","id","body","JSON","stringify","console","log","msg","onUpdateReport","e","onDeleteReport","updateAllReport","then","res","map","report","option","timestamp","description","contact","infos","timestampToSTDTime","date","Date","year","getFullYear","month","getMonth","day","getDate","hours","getHours","minutes","getMinutes","STDTime","substr","img"],"mappings":"ukBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,WAArC,KAAwD,OAAxD,CACA,MAAOC,CAAAA,MAAP,KAAmB,cAAnB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAE1B;AAF0B,cAGIN,QAAQ,CAAC,EAAD,CAHZ,wCAGnBO,OAHmB,eAGVC,UAHU,eAK1B,GAAMC,CAAAA,kBAAkB,0FAAG,2KACJC,CAAAA,KAAK,CAAC,oBAAD,CAAuB,CAC/CC,MAAM,CAAE,MADuC,CAE/CC,OAAO,CAAE,CACP,SAAS,kBADF,CAEP,eAAe,kBAFR,CAFsC,CAAvB,CADD,QACrBC,QADqB,qCASRA,CAAAA,QAAQ,CAACC,IAAT,EATQ,QASrBC,IATqB,oBAUtBA,IAAI,EAAIA,IAAI,CAACC,OAAL,GAAiB,IAVH,0DAYhBD,IAAI,CAACA,IAZW,yCAclB,IAdkB,wDAAH,kBAAlBN,CAAAA,kBAAkB,0CAAxB,CAiBA,GAAMQ,CAAAA,kBAAkB,2FAAG,kBAAMC,EAAN,+JACJR,CAAAA,KAAK,CAAC,mBAAD,CAAsB,CAC9CC,MAAM,CAAE,MADsC,CAE9CC,OAAO,CAAE,CACP,SAAS,kBADF,CAEP,eAAe,kBAFR,CAFqC,CAM9CO,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBH,EAAE,CAAEA,EADe,CAAf,CANwC,CAAtB,CADD,QACrBL,QADqB,uCAYRA,CAAAA,QAAQ,CAACC,IAAT,EAZQ,QAYrBC,IAZqB,gBAazB,GAAGA,IAAI,EAAIA,IAAI,CAACC,OAAL,GAAiB,IAA5B,CAAkC,CAChCM,OAAO,CAACC,GAAR,CAAYR,IAAI,CAACS,GAAjB,EACD,CAfwB,iCAgBlB,IAhBkB,0DAAH,kBAAlBP,CAAAA,kBAAkB,6CAAxB,CAmBA,GAAMQ,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,CAAD,CAAO,CAC5BJ,OAAO,CAACC,GAAR,CAAY,sBAAwBG,CAApC,EAED,CAHD,CAKA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACD,CAAD,CAAO,CAC5B;AACAT,kBAAkB,CAACS,CAAD,CAAlB,CACD,CAHD,CAKA,GAAME,CAAAA,eAAe,CAAG1B,WAAW,CAAC,UAAM,CACxCO,kBAAkB,GACfoB,IADH,CACQ,SAAAC,GAAG,QACPA,CAAAA,GAAG,CAACC,GAAJ,CAAQ,SAAAC,MAAM,CAAI,CACd,MAAO,CACLd,EAAE,CAAEc,MAAM,CAACd,EADN,CAELe,MAAM,CAAED,MAAM,CAACC,MAFV,CAGLC,SAAS,CAAEF,MAAM,CAACE,SAHb,CAILC,WAAW,CAAEH,MAAM,CAACG,WAJf,CAKLC,OAAO,CAAEJ,MAAM,CAACI,OALX,CAAP,CAOH,CARD,CADO,EADX,EAYGP,IAZH,CAYQ,SAAAQ,KAAK,QAAI7B,CAAAA,UAAU,CAAC6B,KAAD,CAAd,EAZb,EAaD,CAdkC,CAchC,EAdgC,CAAnC,CAgBApC,SAAS,CAAC,UAAM,CACd2B,eAAe,GAChB,CAFQ,CAEN,CAACA,eAAD,CAAkBrB,OAAlB,CAFM,CAAT,CAIA,GAAM+B,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACJ,SAAD,CAAe,CAExC,GAAIK,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,CAASN,SAAT,CAAX,CAEA,GAAIO,CAAAA,IAAI,CAAGF,IAAI,CAACG,WAAL,EAAX,CACA,GAAIC,CAAAA,KAAK,CAAGJ,IAAI,CAACK,QAAL,GAAkB,CAA9B,CACA,GAAIC,CAAAA,GAAG,CAAGN,IAAI,CAACO,OAAL,EAAV,CAEA;AACA,GAAIC,CAAAA,KAAK,CAAGR,IAAI,CAACS,QAAL,EAAZ,CACA;AACA,GAAIC,CAAAA,OAAO,CAAG,IAAMV,IAAI,CAACW,UAAL,EAApB,CAEA,GAAIC,CAAAA,OAAO,CAAGV,IAAI,CAAG,GAAP,CAAaE,KAAb,CAAqB,GAArB,CAA2BE,GAA3B,CAAiC,GAAjC,CAAuCE,KAAvC,CAA+C,GAA/C,CAAqDE,OAAO,CAACG,MAAR,CAAe,CAAC,CAAhB,CAAnE,CACA,MAAOD,CAAAA,OAAP,CACD,CAfD,CAiBA,mBACE,YAAK,SAAS,CAAC,WAAf,UACG5C,OAAO,CAACwB,GAAR,CAAY,SAAAsB,GAAG,qBACd,aAAK,SAAS,CAAC,KAAf,wBACE,aAAK,SAAS,CAAC,QAAf,wBACE,YAAK,GAAG,CAAElD,MAAV,CAAkB,GAAG,CAAC,EAAtB,EADF,cAGE,KAAC,YAAD,EACE,EAAE,CAAEkD,GAAG,CAACnC,EADV,CAEE,MAAM,CAAEmC,GAAG,CAACpB,MAAJ,GAAa,CAAb,CAAe,IAAf,CAAoB,IAF9B,CAGE,IAAI,CAAEoB,GAAG,CAACnB,SAHZ,CAIE,IAAI,CAAEmB,GAAG,CAAClB,WAJZ,CAKE,OAAO,CAAEkB,GAAG,CAACjB,OALf,CAME,QAAQ,CAAE,0BAAMX,CAAAA,cAAc,CAAC4B,GAAG,CAACnC,EAAL,CAApB,EANZ,EAHF,cAYE,KAAC,YAAD,EACE,EAAE,CAAEmC,GAAG,CAACnC,EADV,CAEE,QAAQ,CAAE,0BAAMS,CAAAA,cAAc,CAAC0B,GAAG,CAACnC,EAAL,CAApB,EAFZ,EAZF,GADF,cAkBE,YAAK,SAAS,CAAC,SAAf,uBACE,aAAK,SAAS,CAAC,SAAf,wBACE,YAAI,cAAamC,GAAG,CAACpB,MAArB,wBAA6B,mBAAIoB,GAAG,CAACpB,MAAJ,GAAa,CAAb,CAAe,GAAf,CAAmB,GAAvB,EAA7B,YAAgEK,kBAAkB,CAACe,GAAG,CAACnB,SAAL,CAAlF,GADF,cAEE,qBAAImB,GAAG,CAAClB,WAAR,UACCkB,GAAG,CAACpB,MAAJ,GAAa,CAAb,CAAe,KAAf,CAAqB,KADtB,wBACkCoB,GAAG,CAACjB,OADtC,GAFF,GADF,EAlBF,GADc,EAAf,CADH,EADF,CAgCD,CAxHD,CA0HA,cAAe9B,CAAAA,aAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport dinner from './dinner.png';\r\nimport DialogUpdate from './DialogUpdate';\r\nimport DialogDelete from './DialogDelete';\r\n\r\nconst ExistedReport = () => {\r\n\r\n  // const [images, setImages] = useState([]);\r\n  const [reports, setReports] = useState([]);\r\n\r\n  const getAllReportFromDB = async() => {\r\n    let response = await fetch('/api/findAllReport', {\r\n      method: 'post',\r\n      headers: {\r\n        'Accept':'application/json',\r\n        'Content-Type':'application/json'\r\n      }\r\n    });\r\n\r\n    let data = await response.json();\r\n    if(data && data.success === true) {\r\n      // console.log(\"From Existed Report.js...\");\r\n      return data.data;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  const deleteReportFromDB = async(id) => {\r\n    let response = await fetch('/api/deleteReport', {\r\n      method: 'post',\r\n      headers: {\r\n        'Accept':'application/json',\r\n        'Content-Type':'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        id: id\r\n      })\r\n    });\r\n\r\n    let data = await response.json();\r\n    if(data && data.success === true) {\r\n      console.log(data.msg);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  const onUpdateReport = (e) => {\r\n    console.log(\"Updated Report ID: \" + e);\r\n\r\n  }\r\n\r\n  const onDeleteReport = (e) => {\r\n    // console.log(\"Deleted Report ID: \" + e);\r\n    deleteReportFromDB(e);\r\n  }\r\n\r\n  const updateAllReport = useCallback(() => {\r\n    getAllReportFromDB()\r\n      .then(res =>\r\n        res.map(report => {\r\n            return {\r\n              id: report.id,\r\n              option: report.option,\r\n              timestamp: report.timestamp,\r\n              description: report.description,\r\n              contact: report.contact\r\n            };\r\n        })\r\n      )\r\n      .then(infos => setReports(infos));\r\n  }, []);\r\n  \r\n  useEffect(() => {\r\n    updateAllReport();\r\n  }, [updateAllReport, reports]);\r\n\r\n  const timestampToSTDTime = (timestamp) => {\r\n\r\n    let date = new Date(timestamp);\r\n\r\n    let year = date.getFullYear();\r\n    let month = date.getMonth() + 1;\r\n    let day = date.getDate();\r\n\r\n    // Hours part from the timestamp\r\n    let hours = date.getHours();\r\n    // Minutes part from the timestamp\r\n    let minutes = \"0\" + date.getMinutes();\r\n\r\n    let STDTime = year + '-' + month + '-' + day + ' ' + hours + ':' + minutes.substr(-2);\r\n    return STDTime;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      {reports.map(img => (\r\n        <div className=\"box\">\r\n          <div className=\"imgBox\">\r\n            <img src={dinner} alt=\"\"></img>\r\n            {/* pass the id from here instead of returning from children - Faster */}\r\n            <DialogUpdate \r\n              id={img.id}\r\n              option={img.option===0?'遺失':'拾獲'}\r\n              time={img.timestamp}\r\n              desc={img.description}\r\n              contact={img.contact}\r\n              onUpdate={() => onUpdateReport(img.id)}\r\n            />\r\n            {/* pass the id from here instead of returning from children - Faster */}\r\n            <DialogDelete \r\n              id={img.id} \r\n              onDelete={() => onDeleteReport(img.id)}\r\n            /> \r\n          </div>\r\n          <div className=\"details\">\r\n            <div className=\"content\">\r\n              <h5 data-status={img.option}><b>{img.option===0?\"失\":\"報\"}</b> 於 {timestampToSTDTime(img.timestamp)}</h5>\r\n              <p>{img.description}，\r\n              {img.option===0?\"如拾獲\":\"欲取回\"}請聯絡: {img.contact}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ExistedReport;"]},"metadata":{},"sourceType":"module"}